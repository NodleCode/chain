<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Substrate state machine implementation."><meta name="keywords" content="rust, rustlang, rust-lang, sp_state_machine"><title>sp_state_machine - Rust</title><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../ayu.css" disabled ><script id="default-settings"></script><script src="../storage.js"></script><script src="../crates.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="icon" type="image/svg+xml" href="../favicon.svg">
<link rel="alternate icon" type="image/png" href="../favicon-16x16.png">
<link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><style type="text/css">#crate-search{background-image:url("../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../sp_state_machine/index.html'><div class='logo-container rust-logo'><img src='../rust-logo.png' alt='logo'></div></a><p class="location">Crate sp_state_machine</p><div class="block version"><p>Version 0.9.0</p></div><div class="sidebar-elems"><a id="all-types" href="all.html"><p>See all sp_state_machine's items</p></a><div class="block items"><ul><li><a href="#reexports">Re-exports</a></li><li><a href="#modules">Modules</a></li><li><a href="#macros">Macros</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#traits">Traits</a></li><li><a href="#functions">Functions</a></li><li><a href="#types">Type Definitions</a></li></ul></div><p class="location"></p><div id="sidebar-vars" data-name="sp_state_machine" data-ty="mod" data-relpath="../"></div><script defer src="../sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu"><img src="../brush.svg" width="18" height="18" alt="Pick another theme!"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" class="help-button">?</button>
                <a id="settings-menu" href="../settings.html"><img src="../wheel.svg" width="18" height="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Crate <a class="mod" href="">sp_state_machine</a><button id="copy-path" onclick="copy_path(this)">⎘</button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../src/sp_state_machine/lib.rs.html#18-1574" title="goto source code">[src]</a></span></h1><div class="docblock"><p>Substrate state machine implementation.</p>
</div><h2 id="reexports" class="section-header"><a href="#reexports">Re-exports</a></h2>
<table><tr class="import-item"><td><code>pub use crate::backend::<a class="trait" href="backend/trait.Backend.html" title="trait sp_state_machine::backend::Backend">Backend</a>;</code></td><td class="docblock-short"></td></tr></table><h2 id="modules" class="section-header"><a href="#modules">Modules</a></h2>
<table><tr class="module-item"><td><a class="mod" href="backend/index.html" title="sp_state_machine::backend mod">backend</a></td><td class="docblock-short"><p>State machine backends. These manage the code and storage of contracts.</p>
</td></tr></table><h2 id="macros" class="section-header"><a href="#macros">Macros</a></h2>
<table><tr class="module-item"><td><a class="macro" href="macro.debug.html" title="sp_state_machine::debug macro">debug</a></td><td class="docblock-short"><p>Logs a message at the debug level.</p>
</td></tr><tr class="module-item"><td><a class="macro" href="macro.log_error.html" title="sp_state_machine::log_error macro">log_error</a></td><td class="docblock-short"><p>Logs a message at the error level.</p>
</td></tr><tr class="module-item"><td><a class="macro" href="macro.trace.html" title="sp_state_machine::trace macro">trace</a></td><td class="docblock-short"><p>Logs a message at the trace level.</p>
</td></tr><tr class="module-item"><td><a class="macro" href="macro.warn.html" title="sp_state_machine::warn macro">warn</a></td><td class="docblock-short"><p>Logs a message at the warn level.</p>
</td></tr></table><h2 id="structs" class="section-header"><a href="#structs">Structs</a></h2>
<table><tr class="module-item"><td><a class="struct" href="struct.BasicExternalities.html" title="sp_state_machine::BasicExternalities struct">BasicExternalities</a></td><td class="docblock-short"><p>Simple Map-based Externalities impl.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.ChangesTrieAnchorBlockId.html" title="sp_state_machine::ChangesTrieAnchorBlockId struct">ChangesTrieAnchorBlockId</a></td><td class="docblock-short"><p>Block identifier that could be used to determine fork of this block.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.ChangesTrieBuildCache.html" title="sp_state_machine::ChangesTrieBuildCache struct">ChangesTrieBuildCache</a></td><td class="docblock-short"><p>Changes trie build cache.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.ChangesTrieConfigurationRange.html" title="sp_state_machine::ChangesTrieConfigurationRange struct">ChangesTrieConfigurationRange</a></td><td class="docblock-short"><p>Blocks range where configuration has been constant.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.ChangesTrieState.html" title="sp_state_machine::ChangesTrieState struct">ChangesTrieState</a></td><td class="docblock-short"><p>Changes tries state at some block.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.Ext.html" title="sp_state_machine::Ext struct">Ext</a></td><td class="docblock-short"><p>Wraps a read-only backend, call executor, and current overlayed changes.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.InMemoryChangesTrieStorage.html" title="sp_state_machine::InMemoryChangesTrieStorage struct">InMemoryChangesTrieStorage</a></td><td class="docblock-short"><p>In-memory implementation of changes trie storage.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.OffchainOverlayedChanges.html" title="sp_state_machine::OffchainOverlayedChanges struct">OffchainOverlayedChanges</a></td><td class="docblock-short"><p>In-memory storage for offchain workers recoding changes for the actual offchain storage implementation.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.OverlayedChanges.html" title="sp_state_machine::OverlayedChanges struct">OverlayedChanges</a></td><td class="docblock-short"><p>The set of changes that are overlaid onto the backend.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.ProvingBackend.html" title="sp_state_machine::ProvingBackend struct">ProvingBackend</a></td><td class="docblock-short"><p>Patricia trie-based backend which also tracks all touched storage trie values.
These can be sent to remote node and used as a proof of execution.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.ProvingBackendRecorder.html" title="sp_state_machine::ProvingBackendRecorder struct">ProvingBackendRecorder</a></td><td class="docblock-short"><p>Patricia trie-based backend specialized in get value proofs.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.ReadOnlyExternalities.html" title="sp_state_machine::ReadOnlyExternalities struct">ReadOnlyExternalities</a></td><td class="docblock-short"><p>Simple read-only externalities for any backend.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.StateMachine.html" title="sp_state_machine::StateMachine struct">StateMachine</a></td><td class="docblock-short"><p>The substrate state machine.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.StateMachineStats.html" title="sp_state_machine::StateMachineStats struct">StateMachineStats</a></td><td class="docblock-short"><p>Accumulated usage statistics specific to state machine
crate.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.StorageChanges.html" title="sp_state_machine::StorageChanges struct">StorageChanges</a></td><td class="docblock-short"><p>A storage changes structure that can be generated by the data collected in <a href="struct.OverlayedChanges.html" title="OverlayedChanges"><code>OverlayedChanges</code></a>.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.StorageProof.html" title="sp_state_machine::StorageProof struct">StorageProof</a></td><td class="docblock-short"><p>A proof that some set of key-value pairs are included in the storage trie. The proof contains
the storage values so that the partial storage backend can be reconstructed by a verifier that
does not already have access to the key-value pairs.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.StorageTransactionCache.html" title="sp_state_machine::StorageTransactionCache struct">StorageTransactionCache</a></td><td class="docblock-short"><p>The storage transaction are calculated as part of the <code>storage_root</code> and
<code>changes_trie_storage_root</code>. These transactions can be reused for importing the block into the
storage. So, we cache them to not require a recomputation of those transactions.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.TestExternalities.html" title="sp_state_machine::TestExternalities struct">TestExternalities</a></td><td class="docblock-short"><p>Simple HashMap-based Externalities impl.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.TrieBackend.html" title="sp_state_machine::TrieBackend struct">TrieBackend</a></td><td class="docblock-short"><p>Patricia trie-based backend. Transaction type is an overlay of changes to commit.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.UsageInfo.html" title="sp_state_machine::UsageInfo struct">UsageInfo</a></td><td class="docblock-short"><p>Usage statistics for state backend.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.UsageUnit.html" title="sp_state_machine::UsageUnit struct">UsageUnit</a></td><td class="docblock-short"><p>Measured count of operations and total bytes.</p>
</td></tr></table><h2 id="enums" class="section-header"><a href="#enums">Enums</a></h2>
<table><tr class="module-item"><td><a class="enum" href="enum.BackendTrustLevel.html" title="sp_state_machine::BackendTrustLevel enum">BackendTrustLevel</a></td><td class="docblock-short"><p>Storage backend trust level.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.ChangesTrieCacheAction.html" title="sp_state_machine::ChangesTrieCacheAction enum">ChangesTrieCacheAction</a></td><td class="docblock-short"><p>The action to perform when block-with-changes-trie is imported.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.ExecutionError.html" title="sp_state_machine::ExecutionError enum">ExecutionError</a></td><td class="docblock-short"><p>Externalities Error.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.ExecutionManager.html" title="sp_state_machine::ExecutionManager enum">ExecutionManager</a></td><td class="docblock-short"><p>Like <code>ExecutionStrategy</code> only it also stores a handler in case of consensus failure.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.ExecutionStrategy.html" title="sp_state_machine::ExecutionStrategy enum">ExecutionStrategy</a></td><td class="docblock-short"><p>Strategy for executing a call into the runtime.</p>
</td></tr></table><h2 id="traits" class="section-header"><a href="#traits">Traits</a></h2>
<table><tr class="module-item"><td><a class="trait" href="trait.ChangesTrieBlockNumber.html" title="sp_state_machine::ChangesTrieBlockNumber trait">ChangesTrieBlockNumber</a></td><td class="docblock-short"><p>Requirements for block number that can be used with changes tries.</p>
</td></tr><tr class="module-item"><td><a class="trait" href="trait.ChangesTrieRootsStorage.html" title="sp_state_machine::ChangesTrieRootsStorage trait">ChangesTrieRootsStorage</a></td><td class="docblock-short"><p>Changes trie storage. Provides access to trie roots and trie nodes.</p>
</td></tr><tr class="module-item"><td><a class="trait" href="trait.ChangesTrieStorage.html" title="sp_state_machine::ChangesTrieStorage trait">ChangesTrieStorage</a></td><td class="docblock-short"><p>Changes trie storage. Provides access to trie roots and trie nodes.</p>
</td></tr><tr class="module-item"><td><a class="trait" href="trait.Error.html" title="sp_state_machine::Error trait">Error</a></td><td class="docblock-short"><p>State Machine Error bound.</p>
</td></tr><tr class="module-item"><td><a class="trait" href="trait.InspectState.html" title="sp_state_machine::InspectState trait">InspectState</a></td><td class="docblock-short"><p>Trait for inspecting state in any backend.</p>
</td></tr><tr class="module-item"><td><a class="trait" href="trait.Storage.html" title="sp_state_machine::Storage trait">Storage</a></td><td class="docblock-short"><p>Patricia trie-based storage trait.</p>
</td></tr><tr class="module-item"><td><a class="trait" href="trait.TrieBackendStorage.html" title="sp_state_machine::TrieBackendStorage trait">TrieBackendStorage</a></td><td class="docblock-short"><p>Key-value pairs storage that is used by trie backend essence.</p>
</td></tr><tr class="module-item"><td><a class="trait" href="trait.TrieMut.html" title="sp_state_machine::TrieMut trait">TrieMut</a></td><td class="docblock-short"><p>A key-value datastore implemented as a database-backed modified Merkle tree.</p>
</td></tr></table><h2 id="functions" class="section-header"><a href="#functions">Functions</a></h2>
<table><tr class="module-item"><td><a class="fn" href="fn.create_proof_check_backend.html" title="sp_state_machine::create_proof_check_backend fn">create_proof_check_backend</a></td><td class="docblock-short"><p>Create proof check backend.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.disabled_changes_trie_state.html" title="sp_state_machine::disabled_changes_trie_state fn">disabled_changes_trie_state</a></td><td class="docblock-short"><p>Create state where changes tries are disabled.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.execution_proof_check.html" title="sp_state_machine::execution_proof_check fn">execution_proof_check</a></td><td class="docblock-short"><p>Check execution proof, generated by <code>prove_execution</code> call.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.execution_proof_check_on_trie_backend.html" title="sp_state_machine::execution_proof_check_on_trie_backend fn">execution_proof_check_on_trie_backend</a></td><td class="docblock-short"><p>Check execution proof on proving backend, generated by <code>prove_execution</code> call.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.key_changes.html" title="sp_state_machine::key_changes fn">key_changes</a></td><td class="docblock-short"><p>Return changes of given key at given blocks range.
<code>max</code> is the number of best known block.
Changes are returned in descending order (i.e. last block comes first).</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.key_changes_proof.html" title="sp_state_machine::key_changes_proof fn">key_changes_proof</a></td><td class="docblock-short"><p>Returns proof of changes of given key at given blocks range.
<code>max</code> is the number of best known block.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.key_changes_proof_check.html" title="sp_state_machine::key_changes_proof_check fn">key_changes_proof_check</a></td><td class="docblock-short"><p>Check key changes proof and return changes of the key at given blocks range.
<code>max</code> is the number of best known block.
Changes are returned in descending order (i.e. last block comes first).</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.key_changes_proof_check_with_db.html" title="sp_state_machine::key_changes_proof_check_with_db fn">key_changes_proof_check_with_db</a></td><td class="docblock-short"><p>Similar to the <code>key_changes_proof_check</code> function, but works with prepared proof storage.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.native_else_wasm.html" title="sp_state_machine::native_else_wasm fn">native_else_wasm</a></td><td class="docblock-short"><p>Evaluate to ExecutionManager::NativeElseWasm, without having to figure out the type.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.new_in_mem.html" title="sp_state_machine::new_in_mem fn">new_in_mem</a></td><td class="docblock-short"><p>Create a new empty instance of in-memory backend.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.prove_child_read.html" title="sp_state_machine::prove_child_read fn">prove_child_read</a></td><td class="docblock-short"><p>Generate child storage read proof.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.prove_child_read_on_trie_backend.html" title="sp_state_machine::prove_child_read_on_trie_backend fn">prove_child_read_on_trie_backend</a></td><td class="docblock-short"><p>Generate storage read proof on pre-created trie backend.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.prove_execution.html" title="sp_state_machine::prove_execution fn">prove_execution</a></td><td class="docblock-short"><p>Prove execution using the given state backend, overlayed changes, and call executor.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.prove_execution_on_trie_backend.html" title="sp_state_machine::prove_execution_on_trie_backend fn">prove_execution_on_trie_backend</a></td><td class="docblock-short"><p>Prove execution using the given trie backend, overlayed changes, and call executor.
Produces a state-backend-specific “transaction” which can be used to apply the changes
to the backing store, such as the disk.
Execution proof is the set of all ‘touched’ storage DBValues from the backend.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.prove_read.html" title="sp_state_machine::prove_read fn">prove_read</a></td><td class="docblock-short"><p>Generate storage read proof.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.prove_read_on_trie_backend.html" title="sp_state_machine::prove_read_on_trie_backend fn">prove_read_on_trie_backend</a></td><td class="docblock-short"><p>Generate storage read proof on pre-created trie backend.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.prune_changes_tries.html" title="sp_state_machine::prune_changes_tries fn">prune_changes_tries</a></td><td class="docblock-short"><p>Prune obsolete changes tries. Pruning happens at the same block, where highest
level digest is created. Pruning guarantees to save changes tries for last
<code>min_blocks_to_keep</code> blocks. We only prune changes tries at <code>max_digest_interval</code>
ranges.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.read_child_proof_check.html" title="sp_state_machine::read_child_proof_check fn">read_child_proof_check</a></td><td class="docblock-short"><p>Check child storage read proof, generated by <code>prove_child_read</code> call.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.read_child_proof_check_on_proving_backend.html" title="sp_state_machine::read_child_proof_check_on_proving_backend fn">read_child_proof_check_on_proving_backend</a></td><td class="docblock-short"><p>Check child storage read proof on pre-created proving backend.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.read_proof_check.html" title="sp_state_machine::read_proof_check fn">read_proof_check</a></td><td class="docblock-short"><p>Check storage read proof, generated by <code>prove_read</code> call.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.read_proof_check_on_proving_backend.html" title="sp_state_machine::read_proof_check_on_proving_backend fn">read_proof_check_on_proving_backend</a></td><td class="docblock-short"><p>Check storage read proof on pre-created proving backend.</p>
</td></tr></table><h2 id="types" class="section-header"><a href="#types">Type Definitions</a></h2>
<table><tr class="module-item"><td><a class="type" href="type.ChangesTrieTransaction.html" title="sp_state_machine::ChangesTrieTransaction type">ChangesTrieTransaction</a></td><td class="docblock-short"><p>Type of changes trie transaction.</p>
</td></tr><tr class="module-item"><td><a class="type" href="type.ChildStorageCollection.html" title="sp_state_machine::ChildStorageCollection type">ChildStorageCollection</a></td><td class="docblock-short"><p>In memory arrays of storage values for multiple child tries.</p>
</td></tr><tr class="module-item"><td><a class="type" href="type.DBValue.html" title="sp_state_machine::DBValue type">DBValue</a></td><td class="docblock-short"><p>Database value</p>
</td></tr><tr class="module-item"><td><a class="type" href="type.DefaultError.html" title="sp_state_machine::DefaultError type">DefaultError</a></td><td class="docblock-short"><p>Default error type to use with state machine trie backend.</p>
</td></tr><tr class="module-item"><td><a class="type" href="type.DefaultHandler.html" title="sp_state_machine::DefaultHandler type">DefaultHandler</a></td><td class="docblock-short"><p>Default handler of the execution manager.</p>
</td></tr><tr class="module-item"><td><a class="type" href="type.InMemoryBackend.html" title="sp_state_machine::InMemoryBackend type">InMemoryBackend</a></td><td class="docblock-short"><p>Trie backend with in-memory storage.</p>
</td></tr><tr class="module-item"><td><a class="type" href="type.Layout.html" title="sp_state_machine::Layout type">Layout</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="type" href="type.MemoryDB.html" title="sp_state_machine::MemoryDB type">MemoryDB</a></td><td class="docblock-short"><p>Reexport from <code>hash_db</code>, with genericity set for <code>Hasher</code> trait.
This uses a noops <code>KeyFunction</code> (key addressing must be hashed or using
an encoding scheme that avoid key conflict).</p>
</td></tr><tr class="module-item"><td><a class="type" href="type.OffchainChangesCollection.html" title="sp_state_machine::OffchainChangesCollection type">OffchainChangesCollection</a></td><td class="docblock-short"><p>In memory array of storage values.</p>
</td></tr><tr class="module-item"><td><a class="type" href="type.ProofRecorder.html" title="sp_state_machine::ProofRecorder type">ProofRecorder</a></td><td class="docblock-short"><p>Global proof recorder, act as a layer over a hash db for recording queried
data.</p>
</td></tr><tr class="module-item"><td><a class="type" href="type.StorageCollection.html" title="sp_state_machine::StorageCollection type">StorageCollection</a></td><td class="docblock-short"><p>In memory array of storage values.</p>
</td></tr><tr class="module-item"><td><a class="type" href="type.StorageKey.html" title="sp_state_machine::StorageKey type">StorageKey</a></td><td class="docblock-short"><p>Storage key.</p>
</td></tr><tr class="module-item"><td><a class="type" href="type.StorageValue.html" title="sp_state_machine::StorageValue type">StorageValue</a></td><td class="docblock-short"><p>Storage value.</p>
</td></tr><tr class="module-item"><td><a class="type" href="type.TrieDBMut.html" title="sp_state_machine::TrieDBMut type">TrieDBMut</a></td><td class="docblock-short"><p>Persistent trie database write-access interface for the a given hasher.</p>
</td></tr></table></section><section id="search" class="content hidden"></section><div id="rustdoc-vars" data-root-path="../" data-current-crate="sp_state_machine" data-search-index-js="../search-index.js" data-search-js="../search.js"></div>
    <script src="../main.js"></script></body></html>